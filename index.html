<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SÂ²-Guidance Project</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@700&family=Source+Serif+Pro:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

    <header class="hero-section">
        <div class="content-wrapper">
            <h2 class="paper-title">
                Stochastic Self-Guidance for Training-Free Enhancement of Diffusion Models
            </h2>
            <div class="author-section">
                <div class="authors">
                    <p class="author-line"><span>Chubin Chen<sup>1,2,*</sup></span><span>Jiashu Zhu<sup>2</sup></span><span>Xiaokun Feng<sup>2,3</sup></span><span>Nisha Huang<sup>1</sup></span></p>
                    <p class="author-line"><span>Meiqi Wu<sup>2,3</sup></span><span>Fangyuan Mao<sup>2</sup></span><span>Jiahong Wu<sup>2,â€¡</sup></span><span>Xiangxiang Chu<sup>2</sup></span><span>Xiu Li<sup>1,â€ </sup></span></p>
                </div>
                <div class="affiliations">
                    <p><sup>1</sup>Tsinghua University &nbsp;&nbsp;&nbsp; <sup>2</sup>AMAP, Alibaba Group &nbsp;&nbsp;&nbsp; <sup>3</sup>CASIA</p>
                </div>
            </div>
            <div class="notes-section">
                <p><sup>*</sup>Work done during the internship at AMAP, Alibaba Group. &nbsp;&nbsp; <sup>â€ </sup>Corresponding author. &nbsp;&nbsp; <sup>â€¡</sup>Project lead.</p>
            </div>
            <div class="notes-section">
                <p>Our team is hiring full-time employees and interns for video generation roles, contact us: hongxi.wjh@alibaba-inc.com.</p>
            </div>
            <nav class="button-container">
                <a href="https://arxiv.org/abs/2312.01323" class="action-button">ðŸ“„ Paper</a>
                <a href="https://github.com/chubin-chen/S2-Guidance" class="action-button">ðŸ’» GitHub</a>
            </nav>
        </div>
    </header>

    <main class="main-content">
        <div class="section" id="abstract">
            <div class="content-wrapper">
                <h2 class="section-title">Abstract</h2>
                <p class="section-text">
                    Classifier-Free Guidance (CFG) is a widely used technique in modern diffusion models for enhancing sample quality and prompt adherence. However, through an empirical analysis on Gaussian mixture modeling with a closed-form solution, we observe a discrepancy between the suboptimal results produced by CFG and the ground truth. The model's excessive reliance on these suboptimal predictions often leads to semantic incoherence and low-quality outputs. To address this issue, we first empirically demonstrate that the model's suboptimal predictions can be effectively refined using sub-networks of the model itself. Building on this insight, we propose <strong>S<sup>2</sup>-Guidance</strong>, a novel method that leverages stochastic block-dropping during the forward process to construct sub-networks, effectively guiding the model away from potential low-quality predictions and toward high-quality outputs. Extensive qualitative and quantitative experiments on text-to-image and text-to-video generation tasks demonstrate that <strong>S<sup>2</sup>-Guidance</strong> delivers superior performance, consistently surpassing CFG and other advanced guidance strategies. Our code will be released.
                </p>
            </div>
        </div>

        <div class="section" id="method">
            <div class="content-wrapper">
                <h2 class="section-title">Method</h2>
                <p class="section-text">
                    Our method, SÂ²-Guidance, operates by injecting noise into intermediate feature maps of the diffusion model's U-Net and then using the model's own denoising capabilities to predict a "cleaner" version of those features. The difference between the original and the cleaner features serves as a guidance signal, steering the overall generation process towards more refined results. The diagram below illustrates the core mechanism.
                </p>
                <img src="assets/method_v2.jpg" alt="Method Overview Diagram" class="method-image">
            </div>
        </div>

        <div class="section" id="gallery">
            <div class="content-wrapper">
                <h2 class="section-title">Gallery</h2>

                <h3 class="subsection-title">Text to Image Generation</h3>
                <div class="gallery-grid">
                    <!-- Image sections remain unchanged -->
                    <div class="comparison-pair"><div class="comparison-content"><div class="comparison-item"><span class="comparison-label">CFG</span><img src="assets/baseline1.jpg" alt="Baseline result for prompt 1"></div><div class="comparison-item"><span class="comparison-label label-ours">Ours</span><img src="assets/ours1.jpg" alt="Our result for prompt 1"></div></div><p class="caption">Prompt: "The bold dramatic strokes of the painter's brush created a stunning abstract masterpiece a work of emotional depth and intensity."</p></div>
                    <div class="comparison-pair"><div class="comparison-content"><div class="comparison-item"><span class="comparison-label">CFG</span><img src="assets/baseline2.jpg" alt="Baseline result for prompt 2"></div><div class="comparison-item"><span class="comparison-label label-ours">Ours</span><img src="assets/ours2.jpg" alt="Our result for prompt 2"></div></div><p class="caption">Prompt: "A floating castle above the clouds, with 'SÂ² Guidance Is All You Need' swirling in the mist."</p></div>
                    <div class="comparison-pair"><div class="comparison-content"><div class="comparison-item"><span class="comparison-label">CFG</span><img src="assets/baseline3.jpg" alt="Baseline result for prompt 2"></div><div class="comparison-item"><span class="comparison-label label-ours">Ours</span><img src="assets/ours3.jpg" alt="Our result for prompt 2"></div></div><p class="caption">Prompt: "A woman is holding a bouquet of balloons and celebrating a birthday."</p></div>
                    <div class="comparison-pair"><div class="comparison-content"><div class="comparison-item"><span class="comparison-label">CFG</span><img src="assets/baseline4.jpg" alt="Baseline result for prompt 2"></div><div class="comparison-item"><span class="comparison-label label-ours">Ours</span><img src="assets/ours4.jpg" alt="Our result for prompt 2"></div></div><p class="caption">Prompt: "A red book and an ivory sheep. "</p></div>
                    <div class="comparison-pair"><div class="comparison-content"><div class="comparison-item"><span class="comparison-label">CFG</span><img src="assets/baseline5.jpg" alt="Baseline result for prompt 2"></div><div class="comparison-item"><span class="comparison-label label-ours">Ours</span><img src="assets/ours5.jpg" alt="Our result for prompt 2"></div></div><p class="caption">Prompt: "A cat sitting besides a rocket on a planet with a lot of cactuses."</p></div>
                    <div class="comparison-pair"><div class="comparison-content"><div class="comparison-item"><span class="comparison-label">CFG</span><img src="assets/baseline6.jpg" alt="Baseline result for prompt 2"></div><div class="comparison-item"><span class="comparison-label label-ours">Ours</span><img src="assets/ours6.jpg" alt="Our result for prompt 2"></div></div><p class="caption">Prompt: "A woman sitting under an umbrella in the middle of a restaurant."</p></div>
                </div>

                <h3 class="subsection-title">Text to Video Generation</h3>
                <div class="gallery-grid gallery-grid-videos">
                    <!-- è§†é¢‘å¯¹æ¯”ç»„ 1 -->
                    <div class="comparison-pair">
                        <div class="comparison-content">
                            <div class="comparison-item">
                                <span class="comparison-label">CFG</span>
                                <!-- å…³é”®æ”¹åŠ¨ï¼šæ·»åŠ æ’­æ”¾æŒ‰é’®ï¼Œä¿®æ”¹videoæ ‡ç­¾ -->
                                <div class="play-button"><svg viewBox="0 0 24 24"><path d="M8,5.14V19.14L19,12.14L8,5.14Z" /></svg></div>
                                <video preload="metadata" loading="lazy" poster="assets/baseline_video1_poster.jpg" width="100%"><source src="assets/baseline_video1.mp4" type="video/mp4"></video>
                            </div>
                            <div class="comparison-item">
                                <span class="comparison-label label-ours">Ours</span>
                                <!-- å…³é”®æ”¹åŠ¨ï¼šæ·»åŠ æ’­æ”¾æŒ‰é’®ï¼Œä¿®æ”¹videoæ ‡ç­¾ -->
                                <div class="play-button"><svg viewBox="0 0 24 24"><path d="M8,5.14V19.14L19,12.14L8,5.14Z" /></svg></div>
                                <video preload="metadata" loading="lazy" poster="assets/ours_video1_poster.jpg" width="100%"><source src="assets/ours_video1.mp4" type="video/mp4"></video>
                            </div>
                        </div>
                        <p class="caption">Prompt: "A breathtaking close-up of a woman frozen in time..."</p>
                    </div>

                    <!-- è§†é¢‘å¯¹æ¯”ç»„ 2 -->
                    <div class="comparison-pair">
                        <div class="comparison-content">
                            <div class="comparison-item">
                                <span class="comparison-label">CFG</span>
                                <div class="play-button"><svg viewBox="0 0 24 24"><path d="M8,5.14V19.14L19,12.14L8,5.14Z" /></svg></div>
                                <video preload="metadata" loading="lazy" poster="assets/baseline_video2_poster.jpg" width="100%"><source src="assets/baseline_video2.mp4" type="video/mp4"></video>
                            </div>
                            <div class="comparison-item">
                                <span class="comparison-label label-ours">Ours</span>
                                <div class="play-button"><svg viewBox="0 0 24 24"><path d="M8,5.14V19.14L19,12.14L8,5.14Z" /></svg></div>
                                <video preload="metadata" loading="lazy" poster="assets/ours_video2_poster.jpg" width="100%"><source src="assets/ours_video2.mp4" type="video/mp4"></video>
                            </div>
                        </div>
                        <p class="caption">Prompt: "An astronaut flying in space, zoom out."</p>
                    </div>

                    <!-- è§†é¢‘å¯¹æ¯”ç»„ 3 -->
                    <div class="comparison-pair">
                        <div class="comparison-content">
                             <div class="comparison-item">
                                <span class="comparison-label">CFG</span>
                                <div class="play-button"><svg viewBox="0 0 24 24"><path d="M8,5.14V19.14L19,12.14L8,5.14Z" /></svg></div>
                                <video preload="metadata" loading="lazy" poster="assets/baseline_video3_poster.jpg" width="100%"><source src="assets/baseline_video3.mp4" type="video/mp4"></video>
                            </div>
                             <div class="comparison-item">
                                <span class="comparison-label label-ours">Ours</span>
                                <div class="play-button"><svg viewBox="0 0 24 24"><path d="M8,5.14V19.14L19,12.14L8,5.14Z" /></svg></div>
                                <video preload="metadata" loading="lazy" poster="assets/ours_video3_poster.jpg" width="100%"><source src="assets/ours_video3.mp4" type="video/mp4"></video>
                            </div>
                        </div>
                        <p class="caption">Prompt: "A car accelerating to gain speed."</p>
                    </div>

                    <!-- è§†é¢‘å¯¹æ¯”ç»„ 4 -->
                    <div class="comparison-pair">
                        <div class="comparison-content">
                             <div class="comparison-item">
                                <span class="comparison-label">CFG</span>
                                <div class="play-button"><svg viewBox="0 0 24 24"><path d="M8,5.14V19.14L19,12.14L8,5.14Z" /></svg></div>
                                <video preload="metadata" loading="lazy" poster="assets/baseline_video4_poster.jpg" width="100%"><source src="assets/baseline_video4.mp4" type="video/mp4"></video>
                            </div>
                             <div class="comparison-item">
                                <span class="comparison-label label-ours">Ours</span>
                                <div class="play-button"><svg viewBox="0 0 24 24"><path d="M8,5.14V19.14L19,12.14L8,5.14Z" /></svg></div>
                                <video preload="metadata" loading="lazy" poster="assets/ours_video4_poster.jpg" width="100%"><source src="assets/ours_video4.mp4" type="video/mp4"></video>
                            </div>
                        </div>
                        <p class="caption">Prompt: "A parking meter and a truck."</p>
                    </div>

                </div>
            </div>
        </div>
    </main>
    
    <!-- å…³é”®æ”¹åŠ¨ï¼šæ·»åŠ JavaScriptè„šæœ¬ -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // æ‰¾åˆ°æ‰€æœ‰è§†é¢‘æ‰€åœ¨çš„å®¹å™¨
            const videoContainers = document.querySelectorAll('.gallery-grid-videos .comparison-item');
            
            videoContainers.forEach(container => {
                const video = container.querySelector('video');
                const playButton = container.querySelector('.play-button');

                if (video && playButton) {
                    // ç‚¹å‡»æ’­æ”¾æŒ‰é’®
                    playButton.addEventListener('click', (e) => {
                        e.stopPropagation(); // é˜²æ­¢ç‚¹å‡»äº‹ä»¶å†’æ³¡åˆ°çˆ¶å®¹å™¨
                        video.play();
                    });

                    // ç‚¹å‡»è§†é¢‘æœ¬èº«ï¼ˆæ’­æ”¾/æš‚åœåˆ‡æ¢ï¼‰
                    video.addEventListener('click', () => {
                        if (video.paused) {
                            video.play();
                        } else {
                            video.pause();
                        }
                    });

                    // å½“è§†é¢‘å¼€å§‹æ’­æ”¾æ—¶ï¼Œéšè—æ’­æ”¾æŒ‰é’®
                    video.addEventListener('play', () => {
                        playButton.classList.add('hidden');
                    });

                    // å½“è§†é¢‘æš‚åœæ—¶ï¼Œæ˜¾ç¤ºæ’­æ”¾æŒ‰é’®
                    video.addEventListener('pause', () => {
                        playButton.classList.remove('hidden');
                    });
                }
            });
        });
    </script>

</body>
</html>
